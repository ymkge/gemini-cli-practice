# Excelシート統合ツール

## このツールについて

このプログラムは、一つのExcelファイルに含まれる複数のシートを読み込み、自動的に一つのシートにまとめて、新しいExcelファイルとして保存するためのツールです。給与計算データのような、毎月発生する似たようなフォーマットのファイルを手作業でまとめる手間を省きます。

## 主な機能

このツールには、単にデータをまとめるだけでなく、便利な自動化機能が含まれています。

-   **ヘッダーの自動認識**: シートごとに列の順番やヘッダーの表記が多少異なっていても、プログラムがキーワード（例：「氏名」「基本給」など）を見つけて、正しくデータをまとめます。
-   **日給スタッフの給与自動計算**: 「役付」列に「日額＠12,000円」のような記載がある場合、その日給と出勤日数をもとに月給を自動で計算し、「基本給」と「通勤」の金額を更新します。
-   **データの自動クリーニング**: 出勤日数がないなど、不要と思われる行をルールに基づいて自動的に除外します。
-   **合計行の自動追加**: 最後に、すべての金額列の合計値を計算し、ファイルの最終行に「合計」行として追加します。

## 使い方

使い方は簡単です。以下の3ステップで実行できます。

1.  **入力ファイルを置く**:
    `input` という名前のフォルダの中に、処理したいExcelファイル（`AIデータ.xlsx`）を入れます。

2.  **プログラムを実行する**:
    ターミナル（黒い画面）で、以下のコマンドを実行します。
    ```bash
    python merge_sheets.py
    ```

3.  **結果を確認する**:
    `output` という名前のフォルダの中に、処理済みの `merged_data.xlsx` というファイルが作成されます。

## 設定の変更方法（上級者向け）

スクリプトファイル `merge_sheets.py` の冒頭部分を直接編集することで、いくつかの設定を変更できます。

-   `INPUT_FILE`: 読み込むExcelファイルの場所や名前を変更できます。
-   `OUTPUT_FILE`: 保存されるExcelファイルの場所や名前を変更できます。
-   `DESIRED_TO_KEYWORD_MAP`: 出力されるExcelの列の順番を定義したり、元のファイルから特定の列を見つけるためのキーワードを変更したりできる、このツールの最も重要な設定です。

## 実行に必要な準備（初回のみ）

このプログラムを初めて動かす前に、一度だけ以下の準備が必要です。

このツールは `pandas` という、Excelなどの表データを扱うための専門ライブラリを利用しています。以下のコマンドをターミナル（黒い画面）で実行して、`pandas`をインストールしてください。

```bash
pip install pandas
```