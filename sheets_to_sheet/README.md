# Excelシートのマージ処理

このディレクトリには、複数のシートを持つExcelファイル(`input/AIデータ.xlsx`)を処理し、1つのシートにまとめて出力するPythonスクリプトが含まれています。

## 構成

- `merge_sheets.py`: メインの処理を記述したPythonスクリプトです。
- `input/`: 処理対象のExcelファイルを格納するディレクトリです。ここに統合したいEXCELを入れてください。
- `output/`: 処理結果のExcelファイルが出力されるディレクトリです。

## 処理内容

`merge_sheets.py` は、`input`ディレクトリ内のExcelファイルを読み込み、以下の処理を実行します。

1.  **シートごとのデータ読み込みと解析**: Excelファイル内の各シートを個別に読み込みます。シートごとに3行の複雑なヘッダーを解析し、どの列がどの項目（例：「氏名」「基本給」）に対応するかを動的に特定します。これにより、「役員報酬」のように特定のシートにしか存在しない列にも柔軟に対応します。

2.  **データ抽出とクリーニング**: 以下の条件のいずれかを満たす行のみを有効なデータとして抽出します。
    - 「個人番号」と「役員報酬」の両方に値が存在する
    - 「個人番号」と「基本給」の両方に値が存在する

3.  **データ結合と出力**: 全シートから抽出・整形されたデータを一つに結合し、あらかじめ定義された順序で列を並べ替えた後、`output`ディレクトリにExcelファイルとして保存します。

## 実行方法

1.  必要なライブラリをインストールします。
    ```bash
    python3 -m pip install pandas openpyxl
    ```

2.  スクリプトを実行します。
    ```bash
    python3 merge_sheets.py
    ```