# Excelシートのマージ処理

このディレクトリには、複数のシートを持つExcelファイル(`input/AIデータ.xlsx`)を処理し、1つのシートにまとめて出力するPythonスクリプトが含まれています。

## 構成

- `merge_sheets.py`: メインの処理を記述したPythonスクリプトです。
- `input/`: 処理対象のExcelファイルを格納するディレクトリです。ここに統合したいEXCELを入れてください。
- `output/`: 処理結果のExcelファイルが出力されるディレクトリです。

## 処理内容

`merge_sheets.py` は、設定情報（ファイルパス、列の対応表など）に基づき、以下の関数を順に実行します。

1.  `load_and_combine_sheets()`: `input` ディレクトリ内のExcelファイルを読み込み、全シートのヘッダー部分とデータ部分をそれぞれ結合します。
2.  `map_columns()`: 3行の複雑なヘッダーを解析し、どの列がどの項目（例：「氏名」）に対応するかを特定します。
3.  `process_data()`: 特定された列情報に基づき、データ本体から必要な列のみを抽出し、指定された順序に並べ替えます。また、「個人番号」が空の行を削除します。
4.  `main()`: 上記の関数を順番に呼び出し、最終的な結果を `output` ディレクトリにExcelファイルとして保存します。

## 実行方法

1.  必要なライブラリをインストールします。
    ```bash
    python3 -m pip install pandas openpyxl
    ```
2.  スクリプトを実行します。
    ```bash
    python3 merge_sheets.py
    ```
